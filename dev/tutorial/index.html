<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorials · WaveguideQED.jl</title><meta name="title" content="Tutorials · WaveguideQED.jl"/><meta property="og:title" content="Tutorials · WaveguideQED.jl"/><meta property="twitter:title" content="Tutorials · WaveguideQED.jl"/><meta name="description" content="Documentation for WaveguideQED.jl."/><meta property="og:description" content="Documentation for WaveguideQED.jl."/><meta property="twitter:description" content="Documentation for WaveguideQED.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">WaveguideQED.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">WaveguideQED.jl</a></li><li><a class="tocitem" href="../theoreticalbackground/">Theoretical Background</a></li><li class="is-active"><a class="tocitem" href>Tutorials</a><ul class="internal"><li><a class="tocitem" href="#combining"><span>Combining with QuantumOptics.jl</span></a></li><li><a class="tocitem" href="#Expectation-values"><span>Expectation values</span></a></li><li><a class="tocitem" href="#Multiple-Photons-(2-photon-states)"><span>Multiple Photons (2-photon states)</span></a></li></ul></li><li><a class="tocitem" href="../multiplewaveguides_v2/">Multiple Waveguides</a></li><li><a class="tocitem" href="../beamsplitter/">Beamsplitters</a></li><li><a class="tocitem" href="../input_output/">Input-Output Relations</a></li><li><a class="tocitem" href="../time_delay/">Non-Markovian dynamics</a></li><li><a class="tocitem" href="../gpu_support/">GPU Support</a></li><li><a class="tocitem" href="../API/">API</a></li><li><a class="tocitem" href="../references/">References and suggested readings</a></li><li><span class="tocitem">Experimental or Outdated functionalities</span><ul><li><a class="tocitem" href="../detection/">Detection and Projections</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Tutorials</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tutorials</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/qojulia/WaveguideQED.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/qojulia/WaveguideQED.jl/blob/main/docs/src/tutorial.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="tutorial"><a class="docs-heading-anchor" href="#tutorial">Tutorials</a><a id="tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#tutorial" title="Permalink"></a></h1><p>In this section, we show simple examples that illustrate how to use <strong>WaveguideQED.jl</strong> in combination with <a href="https://qojulia.org/"><code>QuantumOptics.jl</code></a></p><h2 id="combining"><a class="docs-heading-anchor" href="#combining">Combining with QuantumOptics.jl</a><a id="combining-1"></a><a class="docs-heading-anchor-permalink" href="#combining" title="Permalink"></a></h2><p>Basises, states, and operators defined in <code>WaveguideQED.jl</code> can be effortlessly combined with operators from <a href="https://qojulia.org/"><code>QuantumOptics.jl</code></a>. As an example, we are going to consider a waveguide with a single photon pulse impinging on an empty onesided cavity. A sketch of the system can be seen here:</p><p><img src="../illustrations/inputoutput_onewaveguide.png" alt="alt text"/></p><p>We start by defining the basis of the cavity and waveguide:</p><pre><code class="language-julia hljs">using WaveguideQED
using QuantumOptics
times = 0:0.1:10
bw = WaveguideBasis(1,times)
bc = FockBasis(1)</code></pre><p>Next, we want to create the Hamiltonian for the system. The interaction between the waveguide and cavity is at timestep k given by<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> <span>$H_k = i \hbar \sqrt{\gamma / \Delta t}( a^\dagger w_k - a w_k^\dagger)$</span>, where <span>$a$</span> (<span>$a^\dagger$</span>) is the cavity annihilation (creation) operator, <span>$w_k$</span>(<span>$w_k^\dagger$</span>) is the waveguide annihilation (creation) operator, <span>$\gamma$</span> is the leakage rate of the cavity, and <span>$\Delta t = \mathrm{times[2]}-\mathrm{times[1]}$</span> is the width of the time-bin. <code>WaveguideQED.jl</code> follows the same syntax as <a href="https://qojulia.org/"><code>QuantumOptics.jl</code></a>, and operators are defined from a basis. Operators of different Hilbert spaces are then combined using ⊗ (<code>\otimes</code>) or <code>tensor</code>:</p><pre><code class="language-julia hljs">a = destroy(bc)
ad = create(bc)
w = destroy(bw)
wd = create(bw)
dt = times[2] - times[1]
γ = 1
H = im*sqrt(γ/dt)*( ad ⊗ w - a ⊗ wd  )</code></pre><p>With this, we can now simulate the scattering of a single photon with a Gaussian wavefunction scattered on a cavity. We define the initial state as waveguide state as:</p><pre><code class="language-julia hljs">ξ(t,σ,t0) = sqrt(2/σ)* (log(2)/pi)^(1/4)*exp(-2*log(2)*(t-t0)^2/σ^2)
σ,t0 = 1,5
ψ_waveguide = onephoton(bw,ξ,σ,t0)</code></pre><p>Note that the wavefunction <span>$\xi(t)$</span> is assumed to be normalized: <span>$\int_0^\infty \xi(t) dt = 1$</span> when creating waveguide states. If one wants to use a non-normalized function, the keyword <code>norm=true</code> can be passed to <a href="../API/#WaveguideQED.onephoton"><code>onephoton</code></a> to ensure normalization.</p><p>Considering an initially empty cavity, the combined initial state is then:</p><pre><code class="language-julia hljs">ψ_in = fockstate(bc,0) ⊗ ψ_waveguide</code></pre><p>With the initial state, we can then call the solver the get the wavefunction after the interaction with the cavity.</p><pre><code class="language-julia hljs">ψ_out = waveguide_evolution(times,ψ_in,H)</code></pre><p>Plotting the wavefunction and its norm square gives:</p><pre><code class="language-julia hljs">using PyPlot
viewed_state = OnePhotonView(ψ_out)
fig,ax = subplots(1,2,figsize=(9,4.5))
ax[1].plot(times,real.(viewed_state),&quot;r-&quot;,label=&quot;Real part&quot;)
ax[1].set_xlabel(&quot;Time [a.u]&quot;)
ax[1].set_ylabel(L&quot;$\xi(t)$&quot;)

ax[2].plot(times,abs.(viewed_state).^2,&quot;r-&quot;)
ax[2].set_xlabel(&quot;Time [a.u]&quot;)
ax[2].set_ylabel(L&quot;$|\xi(t)|^2$&quot;)</code></pre><p><img src="../scat_onephoton.svg" alt="alt text"/></p><p>We see that the wavefunction has changed after the interaction with the cavity. More specifically, we see how the pulse gets absorbed into the cavity leading to a phase change in the wavefunction. This phase change also leads to destructive interference between the photon being emitted from the cavity and the reflection of the incoming photon. This leads to a dip in the photon wavefunction after the interaction.</p><h2 id="Expectation-values"><a class="docs-heading-anchor" href="#Expectation-values">Expectation values</a><a id="Expectation-values-1"></a><a class="docs-heading-anchor-permalink" href="#Expectation-values" title="Permalink"></a></h2><p>In the previous example, only the state at the final timestep was shown. This shows the output wavefunction, but one might also be interested in intermediate states or expectation values. Expectation values can be outputted from the solver by using the <code>fout</code> keyword. As an example, we can get the number of photons in the cavity as a function of time by:</p><pre><code class="language-julia hljs">n = (ad*a) ⊗ identityoperator(bw)
function exp_na(time,psi)
    expect(n,psi)
end
ψ_out,na = waveguide_evolution(times,ψ_in,H,fout=exp_na)</code></pre><p>If we also want to know the number of photons in the waveguide state as a function of time, another operator to out expectation function as:</p><pre><code class="language-julia hljs">n = (ad*a) ⊗ identityoperator(bw)
n_w = identityoperator(bc) ⊗ (create(bw)*destroy(bw))
function exp_na_and_nw(time,psi)
    (expect(n,psi),expect_waveguide(n_w,psi))
end
ψ_out,na,nw = waveguide_evolution(times,ψ_in,H,fout=exp_na_and_nw)</code></pre><p>Where <code>expect_waveguide(n_w,psi)</code> calculates the expectation value of all times of the pulse at each timestep: <span>$\mathrm{expect\_waveguide(n_w,psi)} = \bra{\psi} \sum_k  I \otimes w_k^\dagger w_k  \ket{\psi}$</span></p><p>This can be plotted as:</p><pre><code class="language-julia hljs">fig,ax = subplots(1,1,figsize=(9,4.5))
ax.plot(times,real.(na),&quot;b-&quot;,label=&quot;na&quot;)
ax.plot(times,real.(nw),&quot;r-&quot;,label=&quot;nw&quot;)
ax.plot(times,real.(nw+na),&quot;g-&quot;,label=&quot;na+nw&quot;)
ax.set_xlabel(&quot;Time [a.u]&quot;)
ax.set_ylabel(&quot;Population&quot;)
ax.legend()
plt.tight_layout()</code></pre><p><img src="../photon_number.svg" alt="alt text"/></p><p>Here we see how the photon wavepacket is partially absorbed into the cavity and then reemitted again.</p><p>If we plot the wavefunction as a function of time (and do some displacing), we can even animate the process:</p><p><img src="../animations/firstgif.gif" alt="alt text"/></p><h2 id="Multiple-Photons-(2-photon-states)"><a class="docs-heading-anchor" href="#Multiple-Photons-(2-photon-states)">Multiple Photons (2-photon states)</a><a id="Multiple-Photons-(2-photon-states)-1"></a><a class="docs-heading-anchor-permalink" href="#Multiple-Photons-(2-photon-states)" title="Permalink"></a></h2><p>In the above, we considered a single-photon state scattering on the cavity. If we instead want to consider more photons, we have to create a basis that allows for more photons. Currently, the maximum number of photons is two. We thus create a waveguide basis with a maximum of two photons with:</p><pre><code class="language-julia hljs">times = 0:0.1:10
bw = WaveguideBasis(2,times)
bc = FockBasis(1)</code></pre><p>The Hamiltonian is still the same:</p><pre><code class="language-julia hljs">w_twophoton = destroy(bw)
wd_twophoton = create(bw)
H_twophoton = im*sqrt(γ/dt)*( ad ⊗ w_twophoton - a ⊗ wd_twophoton  )</code></pre><p>If we want an initial two-photon state, we instead use the function <a href="../API/#WaveguideQED.twophoton"><code>twophoton</code></a> to create a two-photon state <span>$\frac{1}{\sqrt{2}}\left[W^\dagger(\xi)\right]^2|0\rangle = \frac{1}{\sqrt{2}} \int_{t_0}^{t_{end}} d t^{\prime} \int_{t_0}^{t_{end}} d t \ \xi^{(2)}(t,t&#39;) w^\dagger(t) w^\dagger\left(t^{\prime}\right)|0\rangle $ (see [Theory](@ref theory) for details). In the following, we define the two-photon wavefunction $\xi^{(2)}(t,t&#39;) = \xi^{(1)}(t)\xi^{(1)}(t&#39;)$</span> which is thus a product state of two single-photons. </p><pre><code class="language-julia hljs">ξ2(t1,t2,σ,t0) = ξ(t1,σ,t0)*ξ(t2,σ,t0)
σ,t0 = 1,5
ψ_twophoton = 1/sqrt(2)*twophoton(bw,ξ2,σ,t0)
ψ_in_twophoton = fockstate(bc,0) ⊗ ψ_twophoton</code></pre><p>Notice the structure of <code>ξ2(t1,t2,σ,t0)</code>, it now has two time-arguments and the remaining arguments are parameters. If we wanted to allow for two different widths of the single-photon states in the product state, we could have also defined: <code>ξ2(t1,t2,σ1,σ2,t0) = ξ(t1,σ1,t0)*ξ(t2,σ2,t0)</code>. Another important detail is the normalization. <a href="../API/#WaveguideQED.twophoton"><code>twophoton</code></a> only creates <span>$\int_{t_0}^{t_{end}} d t^{\prime} \int_{t_0}^{t_{end}} d t \ \xi^{(2)}(t,t&#39;) w^\dagger(t) w^\dagger \left( t^{\prime} \right) | 0 \rangle$</span> and we thus need the factor of <span>$1/\sqrt{2}$</span> for the state to be normalized. </p><p>In the following, we consider the more simple case of equivalent photons. We solve the two-photon scattering in the following.</p><pre><code class="language-julia hljs">ψ_out = waveguide_evolution(times,ψ_in_twophoton,H_twophoton)</code></pre><p>The resulting scattered two-photon state can be retrieved with the <a href="../API/#WaveguideQED.TwoPhotonView"><code>TwoPhotonView</code></a> structure.</p><pre><code class="language-julia hljs">ψ_out_twophoton = TwoPhotonView(ψ_out)</code></pre><p>We can plot the two-photon state easily with:</p><pre><code class="language-julia hljs">fig,ax = subplots(1,1,figsize=(9,4.5))
plot_twophoton!(ax,ψ_out_twophoton,times)
ax.set_xlabel(L&quot;$t_1$ [$1/\gamma$]&quot;)
ax.set_ylabel(L&quot;$t_2$ [$1/\gamma$]&quot;)</code></pre><p><img src="../twophoton_scat.svg" alt="alt text"/></p><p>Note that per default, the view structures (<a href="../API/#WaveguideQED.OnePhotonView"><code>OnePhotonView</code></a> and <a href="../API/#WaveguideQED.TwoPhotonView"><code>TwoPhotonView</code></a>) pick out the groundstate of all the other bases, which in this case means that we are viewing the state <span>$\ket{\psi} = \ket{0} \otimes \sum_k \sum_j \xi^{(2)}(t,t&#39;) \Delta t w_k^\dagger w_j^\dagger \ket{\emptyset}$</span>. If instead, we wanted to view  <span>$\ket{\psi} = \ket{1} \otimes \sum_k \sum_j \xi^{(2)}(t,t&#39;) \Delta t w_k^\dagger w_j^\dagger \ket{\emptyset}$</span>, we can give and extra indexing argument. In this case, the first basis belongs to the cavity and the state <span>$\ket{1}$</span> has the index <span>$2$</span>, while the second basis is the waveguide basis and we here want the whole state so we give the index &quot;:&quot;. We thus have:</p><pre><code class="language-julia hljs">ψ_out_twophoton_upper = TwoPhotonView(ψ_out,[2,:])</code></pre><p>Since all photons have leaked out of the cavity at the end of the simulation, this state is almost unoccupied which we can see by:</p><pre><code class="language-julia hljs">println(norm(ψ_out_twophoton_upper)^2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0</code></pre><p>and if we plot it, we also get nothing:</p><pre><code class="language-julia hljs">fig,ax = subplots(1,1,figsize=(9,4.5))
plot_twophoton!(ax,ψ_out_twophoton_upper,times)
ax.set_xlabel(L&quot;$t_1$ [$1/\gamma$]&quot;)
ax.set_ylabel(L&quot;$t_2$ [$1/\gamma$]&quot;)</code></pre><p><img src="../twophoton_scat2.svg" alt="alt text"/></p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>[<a href="../references/#Heuck2020Photon-photonCavities">1</a>]</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theoreticalbackground/">« Theoretical Background</a><a class="docs-footer-nextpage" href="../multiplewaveguides_v2/">Multiple Waveguides »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.9.0 on <span class="colophon-date" title="Thursday 20 March 2025 06:59">Thursday 20 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
