<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>GPU Support · WaveguideQED.jl</title><meta name="title" content="GPU Support · WaveguideQED.jl"/><meta property="og:title" content="GPU Support · WaveguideQED.jl"/><meta property="twitter:title" content="GPU Support · WaveguideQED.jl"/><meta name="description" content="Documentation for WaveguideQED.jl."/><meta property="og:description" content="Documentation for WaveguideQED.jl."/><meta property="twitter:description" content="Documentation for WaveguideQED.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">WaveguideQED.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">WaveguideQED.jl</a></li><li><a class="tocitem" href="../theoreticalbackground/">Theoretical Background</a></li><li><a class="tocitem" href="../tutorial/">Tutorials</a></li><li><a class="tocitem" href="../multiplewaveguides_v2/">Multiple Waveguides</a></li><li><a class="tocitem" href="../beamsplitter/">Beamsplitters</a></li><li><a class="tocitem" href="../input_output/">Input-Output Relations</a></li><li><a class="tocitem" href="../time_delay/">Non-Markovian dynamics</a></li><li class="is-active"><a class="tocitem" href>GPU Support</a></li><li><a class="tocitem" href="../API/">API</a></li><li><a class="tocitem" href="../references/">References and suggested readings</a></li><li><span class="tocitem">Experimental or Outdated functionalities</span><ul><li><a class="tocitem" href="../detection/">Detection and Projections</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>GPU Support</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>GPU Support</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/qojulia/WaveguideQED.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/qojulia/WaveguideQED.jl/blob/main/docs/src/gpu_support.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="GPU-Support"><a class="docs-heading-anchor" href="#GPU-Support">GPU Support</a><a id="GPU-Support-1"></a><a class="docs-heading-anchor-permalink" href="#GPU-Support" title="Permalink"></a></h1><p>For particularly large system sizes there can be substantial computational gains by running the simulations on a Graphical Processing Unit (GPU). In WaveguideQED.jl, to run on a GPU, all operators and states (kets) should be &quot;put&quot; on the GPU, meaning they should be converted into CUDA arrays. The WaveguideOperators will then dispatch on custom written GPU kernels, which will significantly speed up the computational time for large systems. The GPU code is written using <a href="https://github.com/JuliaGPU/CUDA.jl">CUDA.jl</a> and it should be installed before the following code will work, see <a href="https://github.com/JuliaGPU/CUDA.jl">CUDA.jl</a> for details.  In the following, we provide an example of how to utilize a GPU.</p><p>To convert operators and kets to GPU arrays we define the following convinience functions:</p><pre><code class="language-julia hljs">using CUDA #Load CUDA

function to_gpu(a::Operator)
    data = cu(map(ComplexF32,a.data))
    gpu_operator = Operator(a.basis_l,a.basis_r,data)
    return gpu_operator
end

function to_gpu(a::Ket)
    data = cu(map(ComplexF32,a.data))
    gpu_ket = Ket(a.basis,data)
    return gpu_ket
end</code></pre><p>We then define the system, its operators, and initial state:</p><pre><code class="language-julia hljs">dt = 0.01
times = 0:dt:10
bw = WaveguideBasis(2, times)
bc = FockBasis(2)


a = destroy(bc)
ad = create(bc)

w = destroy(bw)
wd = create(bw)

ξ₁(t1,σ,t0) = sqrt(2/σ)* (log(2)/pi)^(1/4)*exp(-2*log(2)*(t1-t0)^2/σ^2)
ξ₂(t1,t2,σ1,σ2,t0) = ξ₁(t1,σ1,t0) * ξ₁(t2,σ2,t0) 
width = 1
t0 = 5
ψ = fockstate(bc,0) ⊗ twophoton(bw,1,ξ₂,width,width,t0)</code></pre><p>WaveguideOperators does not need to be converted to a gpu, since they are just symbolic objects representing the action of the waveguide operator, but all system operators and all states need to be converted. In the following, we thus convert the operators and initial states to gpu operators:</p><pre><code class="language-julia hljs">a_gpu = to_gpu(a)
ad_gpu = to_gpu(ad)
ψ_gpu = to_gpu(ψ)</code></pre><p>It is then simple to combine operators to run simulations on the gpu:</p><pre><code class="language-julia hljs">γ = 1
adw_gpu = ad_gpu ⊗ w
wda_gpu = a_gpu ⊗ wd
H_gpu =  sqrt(γ/dt)*(wda_gpu+ adw_gpu)

ψ_out = waveguide_evolution(times,ψ_gpu,H_gpu)</code></pre><p>The above simulation takes around 30s using an Nvidia 3060Ti GPU compared to around 900s using a regular CPU. More gains could be expected with a more high-performance GPU and for larger systems. </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../time_delay/">« Non-Markovian dynamics</a><a class="docs-footer-nextpage" href="../API/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Tuesday 22 April 2025 07:41">Tuesday 22 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
