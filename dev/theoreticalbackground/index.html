<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Theoretical Background · WaveguideQED.jl</title><meta name="title" content="Theoretical Background · WaveguideQED.jl"/><meta property="og:title" content="Theoretical Background · WaveguideQED.jl"/><meta property="twitter:title" content="Theoretical Background · WaveguideQED.jl"/><meta name="description" content="Documentation for WaveguideQED.jl."/><meta property="og:description" content="Documentation for WaveguideQED.jl."/><meta property="twitter:description" content="Documentation for WaveguideQED.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">WaveguideQED.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">WaveguideQED.jl</a></li><li class="is-active"><a class="tocitem" href>Theoretical Background</a><ul class="internal"><li><a class="tocitem" href="#Continuous-Fock-States"><span>Continuous Fock States</span></a></li><li><a class="tocitem" href="#Continuous-two-photon-fock-states"><span>Continuous two-photon fock states</span></a></li></ul></li><li><a class="tocitem" href="../tutorial/">Tutorials</a></li><li><a class="tocitem" href="../multiplewaveguides_v2/">Multiple Waveguides</a></li><li><a class="tocitem" href="../beamsplitter/">Beamsplitters</a></li><li><a class="tocitem" href="../input_output/">Input-Output Relations</a></li><li><a class="tocitem" href="../time_delay/">Non-Markovian dynamics</a></li><li><a class="tocitem" href="../gpu_support/">GPU Support</a></li><li><a class="tocitem" href="../API/">API</a></li><li><a class="tocitem" href="../references/">References and suggested readings</a></li><li><span class="tocitem">Experimental or Outdated functionalities</span><ul><li><a class="tocitem" href="../detection/">Detection and Projections</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Theoretical Background</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Theoretical Background</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/qojulia/WaveguideQED.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/qojulia/WaveguideQED.jl/blob/main/docs/src/theoreticalbackground.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="theory"><a class="docs-heading-anchor" href="#theory">Theoretical Background</a><a id="theory-1"></a><a class="docs-heading-anchor-permalink" href="#theory" title="Permalink"></a></h1><p>In this section, we go over the necessary theory to work with continuous fockstates in the <strong>WaveguideQED.jl</strong></p><h2 id="Continuous-Fock-States"><a class="docs-heading-anchor" href="#Continuous-Fock-States">Continuous Fock States</a><a id="Continuous-Fock-States-1"></a><a class="docs-heading-anchor-permalink" href="#Continuous-Fock-States" title="Permalink"></a></h2><p>The single photon continuous fock state can be defined as:</p><p class="math-container">\[\begin{equation*}
    \ket{\psi} = W^\dagger(\xi) \ket{0} = \int_{t_0}^{t_{end}} \mathrm{d}t \ \xi(t) w^\dagger(t) \ket{\emptyset}
\end{equation*}\]</p><p>here <span>$W^\dagger(\xi)$</span> creates a photon with the wavefunction <span>$\xi(t)$</span>. <span>$w^\dagger(t)$</span> is the creation operator for a photon at time <span>$t$</span>, and it obeys the commutation relation: <span>$\left[w(t),w(t&#39;)\right ] = \delta(t-t&#39;)$</span>. The probability of observing a photon at time <span>$t$</span> is given by: <span>$\bra{\psi} w^\dagger(t) w(t) \ket{\psi} = |\xi^{(1)}(t)|^2$</span>. The interpretation of the wavefunction <span>$\xi^{(1)}(t)$</span>. The wavefunction <span>$\xi(t)$</span> thus describes the temporal distribution of the photon.</p><p>The heart of the photon time-binning is discretizing the continuous fock state into time-bins of width <span>$\Delta t$</span>. The interaction with the emitter/cavity is then assumed to span only one time-bin at a time, corresponding to a spectrally flat interaction between the waveguide and emitter/cavity. We thus discretize the annihilation and creation operators by taking<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>:</p><p class="math-container">\[\begin{equation*}
    w(t_k) = w(k \Delta t) \rightarrow  \frac{w_k}{\sqrt{\Delta t}} \ \ \  \text{with} \ \left[ w_j, w_k^\dagger \right ] = \delta_{jk}
\end{equation*}\]</p><p>where <span>$w_k$</span> is the descritized operator and the factor of <span>$1/\sqrt{\Delta t}$</span> assures the commutator relation in the limit of <span>$\Delta t \rightarrow 0$</span>. We denote the action of the discretized creation operator as: <span>$w_k^\dagger \ket{\emptyset} = \ket{1_k}$</span> meaning a single photon in time-bin <span>$k$</span>. This means that the single photon continuous fock state becomes:</p><p class="math-container">\[\begin{equation*}
    \ket{\psi} = \int_{t_0}^{t_{end}} \mathrm{d}t \ \xi(t) w^\dagger(t) \ket{\emptyset} \rightarrow 
\sum_{k=1}^N \sqrt{\Delta t} \xi(t_k) w_k^\dagger \ket{\emptyset}
\end{equation*}\]</p><p>In <code>WaveguideQED.jl</code>, the time-bins above are represented as elements in arrays corresponding to each time-bin:</p><p><img src="../illustrations/onephoton_array.png" alt="Alt text"/></p><p>Let`s say you want to represent a single photon continuous fock state that starts at <span>$t=0$</span> and ends at <span>$t=10$</span> with <span>$\Delta t = 0.1$</span>. This can be done by creating a waveguide basis defined on such a time interval:a</p><pre><code class="language-julia hljs">using WaveguideQED
times = 0:0.1:10
bw = WaveguideBasis(1,times)</code></pre><p>Notice that the input for WaveguideBasis is <code>1</code> and <code>times</code>. <code>1</code> denotes the maximum excitation number of fockstates (currently can only be 1 or 2), and <code>times</code> the is the time interval over which the continuous fockstate is defined. To define the continuous fockstate, we need to define a wavefunction <span>$\xi$</span>. In the following, we define a Gaussian wavefunction located around <span>$t=5$</span> with a width of <span>$\sigma = 1$</span>:</p><pre><code class="language-julia hljs">ξ(t,σ,t0) = sqrt(2/σ)* (log(2)/pi)^(1/4)*exp(-2*log(2)*(t-t0)^2/σ^2)
σ,t0 = 1,5
ψ = onephoton(bw,ξ,σ,t0)</code></pre><p>This state can be visualized by:</p><pre><code class="language-julia hljs">using PyPlot
viewed_state = OnePhotonView(ψ)
fig,ax = subplots(1,1,figsize=(9,4.5))
ax.plot(times,real.(viewed_state),&quot;r-&quot;)
ax.set_xlabel(&quot;Time [a.u]&quot;)
ax.set_ylabel(L&quot;$\xi(t)$&quot;)</code></pre><p><img src="../one_continuous_fockstate.svg" alt="alt text"/></p><p>The time-binned creation and annihilation operators are easily created from the basis:</p><pre><code class="language-julia hljs">w = destroy(bw)
wd = create(bw)</code></pre><p>The time-bin that the operator acts on is set by either:</p><pre><code class="language-julia hljs">w.timeindex = 10
wd.timeindex = 10</code></pre><p>or:</p><pre><code class="language-julia hljs">set_waveguidetimeindex!(w,10)
set_waveguidetimeindex!(wd,10)</code></pre><p>The effect of the creation operator is to create a photon in timebin k and can be illustrated as:</p><p><img src="../illustrations/one_photon_creation.png" alt="Alt text"/></p><p>This is also seen if we plot the creation operator acting on the vacuum:</p><pre><code class="language-julia hljs">ψ = wd*zerophoton(bw)
viewed_state = OnePhotonView(ψ)
fig,ax = subplots(1,1,figsize=(9,4.5))
ax.plot(times,real.(viewed_state),&quot;r-&quot;);
ax.set_xlabel(&quot;Time [a.u]&quot;)
ax.set_ylabel(L&quot;$\xi(t)$&quot;)
plt.tight_layout()</code></pre><p><img src="../created_onephoton_continuous_fockstate.svg" alt="alt text"/></p><p>We see a spike around <code>t = times[10] = 0.9</code>, where we now created an excitation. In itself, the waveguide basis, states, and operators are not particularly interesting, but when combined with other quantum mechanical systems such as cavities and emitters, the framework can produce powerful results. See <a href="../tutorial/#combining"><code>Combining with QuantumOptics</code></a> for an introduction on how to combine with quantum systems defined in <a href="https://qojulia.org/">&#39;QuantumOptics.jl&#39;</a>.</p><h2 id="Continuous-two-photon-fock-states"><a class="docs-heading-anchor" href="#Continuous-two-photon-fock-states">Continuous two-photon fock states</a><a id="Continuous-two-photon-fock-states-1"></a><a class="docs-heading-anchor-permalink" href="#Continuous-two-photon-fock-states" title="Permalink"></a></h2><p>So far, we have considered only one excitation in the waveguide. We can extend the definition of a one-photon continuous fock state to a two-photon state as<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup>:</p><p class="math-container">\[\begin{align*}
\frac{1}{\sqrt{2}}\left[W^\dagger(\xi)\right]^2|0\rangle &amp;= \frac{1}{\sqrt{2}} \int_{t_0}^{t_{end}} d t^{\prime} \int_{t_0}^{t_{end}} d t \ \xi(t) \xi\left(t^{\prime}\right) w^\dagger(t) w^\dagger\left(t^{\prime}\right)|0\rangle \\
 &amp;= \frac{1}{\sqrt{2}} \int_{t_0}^{t_{end}} d t^{\prime} \int_{t_0}^{t_{end}} d t \ \xi^{(2)}(t,t&#39;) w^\dagger(t) w^\dagger\left(t^{\prime}\right)|0\rangle  
\end{align*}\]</p><p>Here, we here defined the two photon wavefunction <span>$\xi^{(2)}(t,t&#39;) = \xi(t) \xi\left(t^{\prime}\right)$</span>. The state is now defined over two times, which describes the probability of observing photon A at time <span>$t$</span> and photon B at time <span>$t&#39;$</span>. In this case, the state is a product state <span>$\xi^{(2)}(t,t&#39;) = \xi(t) \xi\left(t^{\prime}\right)$</span>, and both probabilities are described by the (same) single photon wavefunction <span>$\xi(t)$</span>, but one could have entangled states across time. This means a non-seperable wavefunction <span>$\xi^{(2)}(t,t&#39;) \neq \xi_1(t)\xi_2(t&#39;)$</span>. For now, we will consider a symmetric and separable state.</p><p>The time-binning is in a similar fashion defined as:</p><p class="math-container">\[\begin{align*}
\frac{1}{\sqrt{2}}\left[W^\dagger(\xi)\right]^2|0\rangle &amp;= \frac{1}{\sqrt{2}} \int_{t_0}^{t_{end}} d t^{\prime} \int_{t_0}^{t_{end}} d t \ \xi(t) \xi\left(t^{\prime}\right) w^\dagger(t) w^\dagger\left(t^{\prime}\right)|0\rangle \\
&amp; \rightarrow \frac{1}{\sqrt{2}} \sum_{i=1}^N \sum_{k=1}^N \xi\left(t_i\right) \xi\left(t_k\right) w^\dagger\left(t_i\right) w^{\dagger}\left(t_k\right)|0\rangle \\
&amp; =\frac{1}{\sqrt{2}} \sum_{i=1}^N \sum_{k \neq i}^N \xi\left(t_i\right) \xi\left(t_k\right) w^{\dagger}\left(t_i\right) w^{\dagger}\left(t_k\right)|0\rangle+\sum_{i=1}^N \xi\left(t_i\right) \xi\left(t_i\right)\left|2 t_i\right\rangle \\
&amp; =\frac{1}{\sqrt{2}} \sum_{i=1}^N \sum_{k&gt;i}^N (\xi\left(t_i\right) \xi\left(t_k\right) + \xi\left(t_k\right) \xi\left(t_i\right)) \left|1_{t_i} 1_{t_k}\right\rangle+\sum_{i=1}^N \xi\left(t_i\right) \xi\left(t_i\right)\left|2 t_i\right\rangle
\end{align*}\]</p><p>The sum is allowed to run over only half of the times due to the symmetry of the photons (it&#39;s equivalent to having one photon at time-bin k and then one photon at time-bin j or one photon at time-bin j and then one photon at time-bin k). This is how the two-photon state is saved in the underlying arrays and can be illustrated as:</p><p><img src="../illustrations/twophoton_array.png" alt="alt text"/></p><p>Creating then is:</p><p><img src="../illustrations/two_photon_creation.png" alt="alt text"/></p><p>We can define a two-photon basis and corresponding operator by:</p><pre><code class="language-julia hljs">bw = WaveguideBasis(2,times)
w = destroy(bw)
wd = create(bw)</code></pre><p>The creation operator can then be visualized by acting on <a href="../API/#WaveguideQED.onephoton"><code>onephoton</code></a> filled with ones. This is seen in the following. Note that the state is visualized as a contour plot mirrored around the diagonal.</p><pre><code class="language-julia hljs">set_waveguidetimeindex!(wd,50)
psi_plot = wd*onephoton(bw,x-&gt;1)
fig,ax = subplots(1,1,figsize=(4.5,4.5))
plot_twophoton!(ax,psi_plot,times)</code></pre><p><img src="../twophoton_created.svg" alt="alt text"/></p><p>If we want to create a two-photon Gaussian state, we instead do:</p><pre><code class="language-julia hljs">ξ(t,σ,t0) = sqrt(2/σ)* (log(2)/pi)^(1/4)*exp(-2*log(2)*(t-t0)^2/σ^2)
ξ2(t1,t2,σ,t0) = ξ(t1,σ,t0)*ξ(t2,σ,t0)
σ,t0 = 1,5
ψ = twophoton(bw,ξ2,σ,t0) / sqrt(2)</code></pre><p>Here, we defined the two-photon equivalent of our single-photon Gaussian state. Note the factor of <span>$\sqrt{2}$</span> that is necessary for the state to be normalized. Alternatively, <code>twophoton(bw,ξ2,σ,t0;norm=true)</code> would return a normalized state. When we visualize it, we now need two times, and we make a contour plot. This is easily done by viewing the two-photon state and using <a href="../API/#WaveguideQED.plot_twophoton!-Tuple{Any, TwoPhotonView, Any}"><code>plot_twophoton!</code></a>: </p><pre><code class="language-julia hljs">viewed_state = TwoPhotonView(ψ)
fig,ax = subplots(1,1,figsize=(4.5,4.5))
plot_twophoton!(ax,viewed_state,times)
ax.set_ylabel(&quot;time [1/γ]&quot;)
ax.set_xlabel(&quot;time [1/γ]&quot;)
plt.tight_layout()</code></pre><p><img src="../two_continuous_fockstate.svg" alt="alt text"/></p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>[<a href="../references/#Heuck2020Photon-photonCavities">1</a>]</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>[<a href="../references/#Baragiola2012N-PhotonSystem">2</a>]</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« WaveguideQED.jl</a><a class="docs-footer-nextpage" href="../tutorial/">Tutorials »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.9.0 on <span class="colophon-date" title="Wednesday 19 March 2025 21:36">Wednesday 19 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
