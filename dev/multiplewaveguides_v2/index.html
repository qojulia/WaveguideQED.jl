<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Multiple Waveguides · WaveguideQED.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">WaveguideQED.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">WaveguideQED.jl</a></li><li><a class="tocitem" href="../theoreticalbackground/">Theoretical Background</a></li><li><a class="tocitem" href="../tutorial/">Tutorials</a></li><li class="is-active"><a class="tocitem" href>Multiple Waveguides</a><ul class="internal"><li><a class="tocitem" href="#lodahl"><span>Scattering on two-level system</span></a></li></ul></li><li><a class="tocitem" href="../input_output/">Input-Output Relations</a></li><li><a class="tocitem" href="../time_delay/">Non-Markovian dynamics</a></li><li><a class="tocitem" href="../API/">API</a></li><li><a class="tocitem" href="../references/">References and suggested readings</a></li><li><span class="tocitem">Experimental or Outdated functionalities</span><ul><li><a class="tocitem" href="../detection/">Detection and Projections</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Multiple Waveguides</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Multiple Waveguides</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/qojulia/WaveguideQED.jl/blob/main/docs/src/multiplewaveguides_v2.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="multiple"><a class="docs-heading-anchor" href="#multiple">Multiple Waveguides</a><a id="multiple-1"></a><a class="docs-heading-anchor-permalink" href="#multiple" title="Permalink"></a></h1><p>In the <a href="../tutorial/#tutorial">tutorial</a>, we considered one waveguide containing one or two waveguides. In <strong>WaveguideQED</strong>, we can also consider problems where we have multiple waveguides or equivalently multiple waveguide modes. We can create a waveguide basis containing two photons and two waveguides with:</p><pre><code class="language-julia hljs">times = 0:0.1:10
dt = times[2] - times[1]
NPhotons = 2
NWaveguides = 2
bw = WaveguideBasis(NPhotons,NWaveguides,times)</code></pre><div class="admonition is-info"><header class="admonition-header">WaveguideBasis(2,2,times) vs. Waveguide $\otimes$ Waveguide</header><div class="admonition-body"><p>Instead of using the custom basis for handling two waveguides, one could instead just do a tensor product between two waveguides basis. This naive approach would look something like:</p><pre><code class="language- hljs">times = 0:0.1:10
bw = WaveguideBasis(2,times)
Btotal = bw ⊗ bw</code></pre><p>However, in the above example, the Hilbert space is of size: 27.594.009!!! What happened? We are now storing waveguide states of the type <span>$\ket{1_k,1_j}_{1}\ket{1_l,1_m}_{2}$</span>, that is two photons in each waveguide. But we wanted to only store up to two excitations and thus there is no possibility of having these states. Instead, we can exploit that only a total of two excitations are present simultaneously in the system. For this, we use the custom basis <a href="../API/#WaveguideQED.WaveguideBasis"><code>WaveguideBasis</code></a> with an additional input stating the number of waveguides:</p><pre><code class="language- hljs">bw = WaveguideBasis(2,2,times)</code></pre><p>The Hilbert space is now of size: 20706. This is still a large Hilbert space, but it is three orders of magnitude smaller than the naive approach as it only scales as <span>$\propto N^2$</span> as compared to <span>$\propto N^4$</span> where <span>$\N$</span> is the number of time-bins.. </p></div></div><p>We can then create the annihilation and creation operators for each waveguide by providing an index to <a href="../API/#QuantumOpticsBase.destroy"><code>destroy</code></a> and <a href="../API/#QuantumOpticsBase.create"><code>create</code></a>.</p><pre><code class="language-julia hljs">wd1 = create(bw,1)
w1 = destroy(bw,1)
wd2 = create(bw,2)
w2 = destroy(bw,2)</code></pre><p>Here <code>wd1</code> creates a photon in waveguide mode <span>$1$</span>: <span>$w_{k,1}^\dagger \ket{\emptyset}_1 \ket{\emptyset}_2 = \ket{1_k}_1 \ket{\emptyset}_2$</span>, and equivalently <code>wd2</code>: <span>$w_{k,2}^\dagger \ket{\emptyset}_1 \ket{\emptyset}_2 = \ket{\emptyset}_1 \ket{1_k}_2$</span>. <span>$\ket{1_k}_i$</span> here denotes an excitation in time-bin <span>$k$</span> in waveguide <span>$i$</span>.   </p><p>Similarly, if we want to create a one-photon state in waveguide 1 or 2 we give <a href="../API/#WaveguideQED.onephoton"><code>onephoton</code></a> an extra waveguide index:</p><pre><code class="language-julia hljs">ξ(t,σ,t0) = sqrt(2/σ)* (log(2)/pi)^(1/4)*exp(-2*log(2)*(t-t0)^2/σ^2)
w_idx = 1
ψ_single_1 = onephoton(bw,w_idx,ξ,2,5)

w_idx = 2
ψ_single_2 = onephoton(bw,w_idx,ξ,2,5)</code></pre><p>where <code>ψ_single_1</code> here denotes the state: <span>$\ket{\psi}_1 = \sum_k \sqrt{\Delta t} \xi(t_k) w_{k,1}^\dagger \ket{\emptyset}  \otimes \ket{\emptyset}$</span> and <code>ψ_single_2</code> equivalently <span>$\ket{\psi}_2 = \ket{\emptyset} \otimes \sum_k \sqrt{\Delta t} \xi(t_k) w_{k,2}^\dagger \ket{\emptyset}$</span>. We can also define two-photons states with:</p><pre><code class="language-julia hljs">ξ2(t1,t2,σ,t0) = ξ(t1,σ,t0)*ξ(t2,σ,t0)
w_idx = 1
ψ_double_1 = twophoton(bw,w_idx,ξ2,2,5)

w_idx = 2
ψ_double_2 = twophoton(bw,w_idx,ξ2,2,5)</code></pre><p>We can even describe a simultaneous excitation in both waveguide states like <span>$\ket{1_i}_1\ket{1_j }_2$</span> by providing two indices:</p><pre><code class="language-julia hljs">ψ_single_1_and_2 = twophoton(bw,[1,2],ξ2,2,5)</code></pre><h2 id="lodahl"><a class="docs-heading-anchor" href="#lodahl">Scattering on two-level system</a><a id="lodahl-1"></a><a class="docs-heading-anchor-permalink" href="#lodahl" title="Permalink"></a></h2><p>As an example of a system with multiple waveguide modes, we consider a two-level system coupled with two directional waveguide modes; a left and a right propagating mode. A sketch of the system can be seen below here:</p><p><img src="../illustrations/twowaveguide.svg" alt="`alt text`"/></p><p>Such a system is also considered experimentally in <a href="https://www.nature.com/articles/s41567-022-01720-x">Le Jeannic, et al. Nat. Phys. 18, 1191–1195 (2022)</a> and we here reproduce the theoretical results shown in the paper. The emitter here couples equally to the two waveguide modes with a total rate of <span>$\gamma$</span>, the Hamiltonian is here: </p><p class="math-container">\[H = i \sqrt{\gamma/2/\Delta t} ( a^\dagger w_1 - a w_1^\dagger) + i \sqrt{\gamma/2/\Delta t} ( a^\dagger w_2 - a w_2^\dagger)\]</p><p>We can define this Hamiltonian, by creating the basis of the emitter and combining it with the waveguide operators:</p><pre><code class="language-julia hljs">be = FockBasis(1)
a = destroy(be)
ad = create(be)
γ = 1
H = im*sqrt(γ/2/dt)*( ad ⊗ w1 - a ⊗ wd1  ) + im*sqrt(γ/2/dt)*( ad ⊗ w2 - a ⊗ wd2  )</code></pre><p>In the above, we denote waveguide <span>$1$</span> as the right propagating mode and waveguide <span>$2$</span> as the left propagating mode.</p><p>We can now study how single or two-photon states scatter on the emitter. We define the initial one-photon or two-photon Gaussian state and solve it using the defined Hamiltonian:</p><pre><code class="language-julia hljs">ξ₁(t1,σ,t0) = sqrt(2/σ)* (log(2)/pi)^(1/4)*exp(-2*log(2)*(t1-t0)^2/σ^2)
ξ₂(t1,t2,σ,t0) = ξ₁(t1,σ,t0) * ξ₁(t2,σ,t0)
w = 1
t0 = 5
ψ1 = fockstate(be,0) ⊗ onephoton(bw,1,ξ₁,w,t0)
ψ2 = fockstate(be,0) ⊗ twophoton(bw,1,ξ₂,w,t0)
ψScat1 = waveguide_evolution(times,ψ1,H)
ψScat2 = waveguide_evolution(times,ψ2,H)</code></pre><p>Viewing the scattered states is then done using TwoPhotonView and the index for the corresponding waveguide. Giving two indices returns the combined single photon state in both waveguides <span>$\sum_{j,k} \ket{1_j}_1 \ket{1_k}_2$</span>:</p><pre><code class="language-julia hljs">ψ2RightScat = TwoPhotonView(ψScat2,1,[1,:])
ψ2LeftScat = TwoPhotonView(ψScat2,2,[1,:])
ψ2LeftRightScat = TwoPhotonView(ψScat2,2,1,[1,:])</code></pre><p>We now want to compare the difference between a two-photon state scattering on the emitter and a single-photon state scattering. The scattered two-photon wavefunction can be expressed as <span>$\xi^{(2)}(t_1,t_2) = \xi^{(1)}(t_1)\xi^{(1)}(t_2) + N(t_1,t_2)$</span>, where <span>$\xi^{(1)}(t)$</span> is the scattered single-photon state and <span>$N(t_1,t_2)$</span> is the bound-state or non-linear contribution of the interaction with the emitter (stimulated emission). Thus, we compare the scattered two-photon state with the product of the scattered single-photon state. We thus calculate the two-time scattered distribution as:</p><pre><code class="language-julia hljs">ψ1RightScat = zeros(ComplexF64,(length(times),length(times)))
ψ1LeftScat = zeros(ComplexF64,(length(times),length(times)))
ψ1LeftRightScat = zeros(ComplexF64,(length(times),length(times)))
ψ1Right = OnePhotonView(ψScat1,1,[1,:])
ψ1Left = OnePhotonView(ψScat1,2,[1,:])

for i in eachindex(times)
    for j in eachindex(times)
        ψ1RightScat[i,j] = ψ1Right[i]*ψ1Right[j]
        ψ1LeftScat[i,j] = ψ1Left[i]*ψ1Left[j]
        ψ1LeftRightScat[i,j] = ψ1Left[i]*ψ1Right[j]
    end
end</code></pre><p>Finally, we can plot the scattered wavefunctions, and we note that this matches Fig. 3 in Ref.<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>:</p><pre><code class="language-julia hljs">fig,axs = subplots(3,2,figsize=(6,9))
plot_list = [ψ2RightScat,ψ2LeftScat,ψ2LeftRightScat,ψ1RightScat,ψ1LeftScat,ψ1LeftRightScat]
for (i,ax) in enumerate(axs)
    plot_twophoton!(ax,plot_list[i],times)
end
axs[1].set_ylabel(&quot;\$C^{RR}\$ \n t2 [a.u]&quot;)
axs[2].set_ylabel(&quot;\$C^{LL}\$ \n t2 [a.u]&quot;)
axs[3].set_ylabel(&quot;\$C^{LR}\$ \n t2 [a.u]&quot;)
axs[3].set_xlabel(&quot;t1 [a.u]&quot;)
axs[6].set_xlabel(&quot;t1 [a.u]&quot;)
plt.tight_layout()</code></pre><p><img src="../lodahl_fig3.svg" alt="lodahl"/></p><p>If we consider the single photon state, we can also visualize the temporal evolution as:</p><p><img src="../animations/lodahl_onephoton_gif.gif" alt="alt text"/></p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><a href="../references/#DynamicalPhotonLodahl2022">Hanna Le Jeannic, Alexey Tiranov, Jacques Carolan, Tomás Ramos, Ying Wang, Martin Hayhurst Appel, Sven Scholz, Andreas D. Wieck, Arne Ludwig, Nir Rotenberg, Leonardo Midolo, Juan José García-Ripoll, Anders S. Sørensen, Peter Lodahl (2022)</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial/">« Tutorials</a><a class="docs-footer-nextpage" href="../input_output/">Input-Output Relations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Saturday 16 December 2023 12:41">Saturday 16 December 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
